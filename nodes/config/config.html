<script type="text/javascript">
  const NODE_ID = 'connio-config';

  const ConfigNode = {
    category: 'config',
    defaults: {
      name: {
        value: 'Connio',
      },
      /** @todo Rename to "authUrl" */
      url: {
        required: true,
      },
      apiUrl: {
        required: true,
      },
      mqttUrl: {
        required: true,
      },
    },
    label() {
      return this.name;
    },
    oneditsave() {
      const nextConfig = {
        url: $('#node-config-input-url').val(),
        apiUrl: $('#node-config-input-apiUrl').val(),
        mqttUrl: $('#node-config-input-mqttUrl').val(),
      };

      if (
        nextConfig.url !== this.url ||
        nextConfig.apiUrl !== this.apiUrl ||
        nextConfig.mqttUrl !== this.mqttUrl
      ) {
        RED.events.emit('@config/update', nextConfig);
      }
    },
  };

  RED.nodes.registerType(NODE_ID, ConfigNode);
</script>

<script type="text/x-red" data-template-name="connio-config">
  <div class="form-row">
    <label for="node-config-input-url">
      <i class="fa fa-globe"></i>
      Auth URL
    </label>

    <input type="text" id="node-config-input-url">
  </div>

  <div class="form-row">
    <label for="node-config-input-apiUrl">
      <i class="fa fa-globe"></i>
      API URL
    </label>

    <input type="text" id="node-config-input-apiUrl">
  </div>

  <div class="form-row">
    <label for="node-config-input-mqttUrl">
      <i class="fa fa-globe"></i>
      MQTT URL
    </label>

    <input type="text" id="node-config-input-mqttUrl">
  </div>

  <hr>

  <div class="form-row">
    <label for="node-config-input-name">
      <i class="icon-tag"></i>
      Name
    </label>

    <input type="text" id="node-config-input-name">
  </div>
</script>
