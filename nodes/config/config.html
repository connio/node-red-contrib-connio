<script type="text/javascript">
  const NODE_ID = 'connio-config';

  const ConfigNode = {
    category: 'config',
    defaults: {
      name: {
        value: 'Connio',
      },
      /** @todo Rename to "authUrl" */
      url: {
        required: true,
      },
      apiUrl: {
        required: true,
      },
      mqttUrl: {
        required: true,
      },
    },
    label() {
      return this.name;
    },
    oneditsave() {
      const nextConfig = {
        url: $('#node-config-input-url').val(),
        apiUrl: $('#node-config-input-apiUrl').val(),
        mqttUrl: $('#node-config-input-mqttUrl').val(),
      };

      if (
        nextConfig.url !== this.url ||
        nextConfig.apiUrl !== this.apiUrl ||
        nextConfig.mqttUrl !== this.mqttUrl
      ) {
        RED.events.emit('@config/update', nextConfig);
      }
    },
  };

  RED.nodes.registerType(NODE_ID, ConfigNode);
</script>

<script type="text/x-red" data-template-name="connio-config">
  <div class="form-row">
    <label for="node-config-input-url">
      <i class="fa fa-globe"></i>
      <span data-i18n="auth-url-field.label"></span>
    </label>

    <input
      type="text"
      id="node-config-input-url"
      data-i18n="[placeholder]auth-url-field.placeholder"
    >
  </div>

  <div class="form-row">
    <label for="node-config-input-apiUrl">
      <i class="fa fa-globe"></i>
      <span data-i18n="api-url-field.label"></span>
    </label>

    <input
      type="text"
      id="node-config-input-apiUrl"
      data-i18n="[placeholder]api-url-field.placeholder"
    >
  </div>

  <div class="form-row">
    <label for="node-config-input-mqttUrl">
      <i class="fa fa-globe"></i>
      <span data-i18n="mqtt-url-field.label"></span>
    </label>

    <input
      type="text"
      id="node-config-input-mqttUrl"
      data-i18n="[placeholder]mqtt-url-field.placeholder"
    >
  </div>

  <hr>

  <div class="form-row">
    <label for="node-config-input-name">
      <i class="icon-tag"></i>
      <span data-i18n="name-field.label"></span>
    </label>

    <input type="text" id="node-config-input-name" data-i18n="[placeholder]name-field.placeholder">
  </div>
</script>
